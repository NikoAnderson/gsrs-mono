<mat-card>
  <mat-card-title>
    <div class="row space-between-row top-align">
      <div class="width-75">
    <ng-container *ngIf="article.doi; then link; else nolink">
    </ng-container>
    <ng-template #link>
      <div class="centered">
      <a href="https://doi.org/{{article.doi}}"
         target="_blank"
         rel="noreferrer"
         aria-label="Link to publication via DOI" class="mat-card-title">{{article.title}}</a>
      <!--<span class="centered" *ngIf = "article.isOpenAccess=== 'N'">
        &nbsp;<mat-icon [color]="'primary'">lock</mat-icon> &nbsp;<span class="small-text">(not open access)</span>
        </span>-->
      </div>
    </ng-template>
    <ng-template #nolink>
      <span class="mat-card-title">{{article.title}}</span>
    </ng-template>
        <div *ngFor="let journal of article.journals">
          <i>{{journal.title}}</i> <span *ngIf="journal.volume">&nbsp;Volume:{{journal.volume}}</span>
        </div>



      </div>
      <div class = "mat-h3" *ngIf = "article.pubmed_id">PMID:
        <a
          href="https://pubmed.ncbi.nlm.nih.gov/{{article.pubmed_id}}"
          target="_blank"
          rel="noreferrer"
          aria-label="Link to publication in PubMed"
        >{{article.pubmed_id}}</a>
      </div>
    </div>
  </mat-card-title>
  <mat-card-content>
  <div class="row space-between-row top-align">
    <div class="width-70">
    <span *ngFor="let author of article.authorsWrote; let last = last">
      <i>{{author.fullName}}</i> <span *ngIf="!last">, </span>
    </span>
      <br>
      <span *ngIf="article.affiliation">{{article.affiliation}}</span><br><br>
    </div>
    <div class="width-25">
      <span class = "mat-h3">First Published: </span> {{article.firstPublicationDate | date}}<br>
      <span class = "mat-h3" *ngIf = "article.citedByCount">Cited By: </span> {{article.citedByCount}}<br>
      <span class = "mat-h3" *ngIf="article.pubType">Publication Type: </span>
      <span *ngFor="let pubType of article.pubType; let last = last">
      <span>{{pubType}}</span> <span *ngIf="!last">, </span>
    </span><br>
    </div>
  </div>
    <div class="row space-between-row">
      <button mat-flat-button [color]="'accent'" *ngIf="article.abstractText && article.abstractText.length"
              (click)="showAbstract = !showAbstract" >{{showAbstract ? 'Hide ' : 'Show '}}Abstract</button>
      <div *ngIf="showAbstract">
      <span class="mat-subtitle-2" [innerHTML]="getArticleAbstract()"></span>
      </div>
    </div>
    <div class="project-content-wrapper">
      <mat-card [appearance]="'outlined'">
        <div class="project-sub-header bottom-border-accent">Other Diseases Mentioned: {{article.diseases ? article.diseases.length : 0 }}</div>
        <br>
        <div *ngFor="let disease of article.diseases">
          <ng-container *ngIf="disease.gardId; then link; else nolink">
          </ng-container>
          <ng-template #link>
            <a href="/disease?id={{disease.gardId}}"
               target="_blank"
               rel="noreferrer"
               aria-label="Link to disease details page">{{disease.name}}</a>
          </ng-template>
          <ng-template #nolink>
            {{disease.name}}
          </ng-template>
          <br>
          <br>
        </div>
      </mat-card>
      <mat-card [appearance]="'outlined'">
        <div class="project-sub-header bottom-border-accent">
        Annotations: {{article.annotations ? article.annotations.length : 0 }}</div>
        <div *ngIf="article.annotations && article.annotations.length">
            <div  *ngFor="let annotation of annotationsMap | keyvalue">
              <div class="primary-chip">{{annotation.key}}</div>
              <div *ngFor="let term of annotation.value" class="annotation-term">{{term}}</div>
            </div>
            <br>
<!--
            <div class="list-item-content">Found In: {{annotation.type}}</div>
-->
        </div>
      </mat-card>
      <mat-card [appearance]="'outlined'">
        <div class="project-sub-header bottom-border-accent">Mesh
          Terms: {{article.meshTerms ? article.meshTerms.length : 0 }}</div>
        <div *ngIf="article.meshTerms && article.meshTerms.length">
          <div *ngFor="let term of article.meshTerms">
            <div class="list-item-content">{{term.qualifierName}}</div>
            <div class="list-item-content">{{term.abbreviation}}</div>
            <div class="list-item-content">{{term.descriptorName}}</div>
          </div>
        </div>
      </mat-card>
    </div>
    <div *ngIf="article.substances && article.substances.length">
     <div class="primary-chip">Substances </div> <br>
      <span *ngFor="let substance of article.substances">
        {{substance.name}}
      </span>
    </div>
    <div *ngIf="article.keywords && article.keywords.length">
     <div class="primary-chip">Keywords </div><br>
      <span *ngFor="let keyword of article.keywords; let last = last">
        {{keyword.keyword}}<span *ngIf="!last">,&nbsp;</span>
      </span>
    </div>
  </mat-card-content>
</mat-card>
