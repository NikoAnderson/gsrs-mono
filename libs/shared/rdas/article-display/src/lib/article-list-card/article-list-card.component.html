<mat-card>
  <mat-card-title>
    <div class="row space-between-row">
      <div class="width-75">
    <ng-container *ngIf="article.doi; then link; else nolink">
    </ng-container>
    <ng-template #link>
      <div class="centered">
      <a href="https://doi.org/{{article.doi}}"
         target="_blank"
         rel="noreferrer"
         aria-label="Link to publication via DOI" class="mat-card-title">{{article.title}}</a>
      <span class="centered" *ngIf = "article.isOpenAccess=== 'N'">
        &nbsp;<mat-icon [color]="'primary'">lock</mat-icon> &nbsp;<span class="small-text">(not open access)</span>
        </span>
      </div>
    </ng-template>
    <ng-template #nolink>
      <span class="mat-card-title">{{article.title}}</span>
    </ng-template>

      </div>
    </div>
  </mat-card-title>
  <mat-card-content>
  <div class="row space-between-row">
    <div class="width-75">
    <span *ngFor="let author of article.authorsWrote; let last = last">
      <i>{{author.fullName}}</i> <span *ngIf="!last">, </span>
    </span><br><br>
      <span *ngIf="article.affiliation">{{article.affiliation}}</span><br><br>
        <div class = "mat-h3" *ngIf = "article.pubmed_id">PMID:
          <a
            href="https://pubmed.ncbi.nlm.nih.gov/{{article.pubmed_id}}"
            target="_blank"
            rel="noreferrer"
            aria-label="Link to publication in PubMed"
          >{{article.pubmed_id}}</a>
        </div>
    </div>
    <div>
      <span class = "mat-h3">First Published: </span> {{article.firstPublicationDate | date}}<br>
      <span class = "mat-h3" *ngIf = "article.citedByCount">Cited By: </span> {{article.citedByCount}}<br>
      <span class = "mat-h3" *ngIf="article.pubType">Publication Type: </span>
      <span *ngFor="let pubType of article.pubType; let last = last">
      <span>{{pubType}}</span> <span *ngIf="!last">, </span>
    </span><br>
    </div>
  </div>
<br>
    <div class="row space-between-row">
    <div class="mat-h2" *ngIf="article.abstractText && article.abstractText.length">Abstract</div>
  <div *ngIf="fullAbstract; else truncated">
    <span class="mat-subtitle-2" [innerHTML]="getArticleAbstract()"></span>
    <a (click) = "fullAbstract = false" *ngIf="fullAbstract && truncatedAbstract" class = "expand-link"> ...less</a>
  </div>
  <ng-template #truncated>
    <span class="mat-subtitle-2" [innerHTML]="getArticleAbstract()"></span>
    <a (click) = "fullAbstract = true" *ngIf="!fullAbstract" class = "expand-link"> ...more</a>
  </ng-template>
    </div>
  {{article.substancesSubstanceAnnotatedByPubmed | json}}
  </mat-card-content>
</mat-card>
